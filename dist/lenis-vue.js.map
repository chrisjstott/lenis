{"version":3,"sources":["../src/index.ts"],"sourcesContent":["import type { LenisOptions, ScrollCallback } from 'lenis'\nimport Lenis from 'lenis'\nimport type { InjectionKey, Plugin, PropType, Ref } from 'vue'\nimport {\n  defineComponent,\n  h,\n  inject,\n  onBeforeUnmount,\n  onMounted,\n  provide,\n  ref,\n  watch,\n} from 'vue'\n\nexport const LenisSymbol: InjectionKey<Ref<Lenis | undefined>> =\n  Symbol('LenisContext')\n\nexport function useLenis(callback?: ScrollCallback) {\n  const lenisInjection = inject(LenisSymbol)\n\n  if (!lenisInjection) {\n    throw new Error('No lenis instance found')\n  }\n\n  watch(lenisInjection, (lenis) => {\n    if (lenis && callback) {\n      lenisInjection.value?.on('scroll', callback)\n    }\n  })\n\n  onBeforeUnmount(() => {\n    if (lenisInjection.value && callback) {\n      lenisInjection.value.off('scroll', callback)\n    }\n  })\n\n  return lenisInjection\n}\n\ntype DivProps = Omit<JSX.IntrinsicElements['div'], 'ref'>\n\nexport interface LenisVueProps {\n  /**\n   * Setup a global instance of Lenis\n   * @default false\n   */\n  root?: boolean\n  /**\n   * Lenis options\n   */\n  options?: LenisOptions\n  /**\n   * Auto-setup requestAnimationFrame\n   * @default true\n   */\n  autoRaf?: boolean\n  /**\n   * Additional props for the wrapper div\n   *\n   * When `root` is `false`, this will be applied to the wrapper div\n   */\n  props?: DivProps\n}\n\nexport const LenisVue = defineComponent({\n  name: 'LenisVue',\n  props: {\n    root: {\n      type: Boolean as PropType<boolean>,\n      default: false,\n    },\n    autoRaf: {\n      type: Boolean as PropType<boolean>,\n      default: true,\n    },\n    options: {\n      type: Object as PropType<ConstructorParameters<typeof Lenis>[0]>,\n      default: () => ({}),\n    },\n    props: {\n      type: Object as PropType<DivProps>,\n      default: () => ({}),\n    },\n  },\n  setup(\n    { autoRaf = true, root = false, options = {}, props = {} }: LenisVueProps,\n    { slots }\n  ) {\n    const lenis = ref<Lenis>()\n    const wrapper = ref<HTMLDivElement>()\n    const content = ref<HTMLDivElement>()\n\n    onMounted(() => {\n      lenis.value = new Lenis({\n        ...options,\n        ...(!root\n          ? {\n              wrapper: wrapper.value,\n              content: content.value,\n            }\n          : {}),\n      })\n\n      if (autoRaf) {\n        function raf(time: number) {\n          lenis.value?.raf(time)\n          requestAnimationFrame(raf)\n        }\n\n        requestAnimationFrame(raf)\n      }\n    })\n\n    onBeforeUnmount(() => {\n      lenis.value?.destroy()\n    })\n\n    provide(LenisSymbol, lenis)\n\n    return () => {\n      if (root) {\n        return slots.default?.()\n      } else {\n        const { className, ...restProps } = props\n        const combinedClassName = ['lenis', className].filter(Boolean).join(' ')\n\n        return h(\n          'div',\n          // This cries about the type, but I don't care. it recieves div props\n          { class: combinedClassName, ref: wrapper, ...(restProps as any) },\n          [h('div', { ref: content }, slots.default?.())]\n        )\n      }\n    }\n  },\n})\n\ndeclare module 'vue' {\n  export interface GlobalComponents {\n    lenis: typeof LenisVue\n  }\n}\n\nconst plugin: Plugin = (app) => {\n  app.component('lenis', LenisVue)\n}\n\nexport default plugin\n"],"mappings":";AACA,OAAO,WAAW;AAElB;AAAA,EACE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACK;AAEA,IAAM,cACX,OAAO,cAAc;AAEhB,SAAS,SAAS,UAA2B;AAClD,QAAM,iBAAiB,OAAO,WAAW;AAEzC,MAAI,CAAC,gBAAgB;AACnB,UAAM,IAAI,MAAM,yBAAyB;AAAA,EAC3C;AAEA,QAAM,gBAAgB,CAAC,UAAU;AAC/B,QAAI,SAAS,UAAU;AACrB,qBAAe,OAAO,GAAG,UAAU,QAAQ;AAAA,IAC7C;AAAA,EACF,CAAC;AAED,kBAAgB,MAAM;AACpB,QAAI,eAAe,SAAS,UAAU;AACpC,qBAAe,MAAM,IAAI,UAAU,QAAQ;AAAA,IAC7C;AAAA,EACF,CAAC;AAED,SAAO;AACT;AA2BO,IAAM,WAAW,gBAAgB;AAAA,EACtC,MAAM;AAAA,EACN,OAAO;AAAA,IACL,MAAM;AAAA,MACJ,MAAM;AAAA,MACN,SAAS;AAAA,IACX;AAAA,IACA,SAAS;AAAA,MACP,MAAM;AAAA,MACN,SAAS;AAAA,IACX;AAAA,IACA,SAAS;AAAA,MACP,MAAM;AAAA,MACN,SAAS,OAAO,CAAC;AAAA,IACnB;AAAA,IACA,OAAO;AAAA,MACL,MAAM;AAAA,MACN,SAAS,OAAO,CAAC;AAAA,IACnB;AAAA,EACF;AAAA,EACA,MACE,EAAE,UAAU,MAAM,OAAO,OAAO,UAAU,CAAC,GAAG,QAAQ,CAAC,EAAE,GACzD,EAAE,MAAM,GACR;AACA,UAAM,QAAQ,IAAW;AACzB,UAAM,UAAU,IAAoB;AACpC,UAAM,UAAU,IAAoB;AAEpC,cAAU,MAAM;AACd,YAAM,QAAQ,IAAI,MAAM;AAAA,QACtB,GAAG;AAAA,QACH,GAAI,CAAC,OACD;AAAA,UACE,SAAS,QAAQ;AAAA,UACjB,SAAS,QAAQ;AAAA,QACnB,IACA,CAAC;AAAA,MACP,CAAC;AAED,UAAI,SAAS;AACX,YAASA,OAAT,SAAa,MAAc;AACzB,gBAAM,OAAO,IAAI,IAAI;AACrB,gCAAsBA,IAAG;AAAA,QAC3B;AAHS,kBAAAA;AAKT,8BAAsBA,IAAG;AAAA,MAC3B;AAAA,IACF,CAAC;AAED,oBAAgB,MAAM;AACpB,YAAM,OAAO,QAAQ;AAAA,IACvB,CAAC;AAED,YAAQ,aAAa,KAAK;AAE1B,WAAO,MAAM;AACX,UAAI,MAAM;AACR,eAAO,MAAM,UAAU;AAAA,MACzB,OAAO;AACL,cAAM,EAAE,WAAW,GAAG,UAAU,IAAI;AACpC,cAAM,oBAAoB,CAAC,SAAS,SAAS,EAAE,OAAO,OAAO,EAAE,KAAK,GAAG;AAEvE,eAAO;AAAA,UACL;AAAA;AAAA,UAEA,EAAE,OAAO,mBAAmB,KAAK,SAAS,GAAI,UAAkB;AAAA,UAChE,CAAC,EAAE,OAAO,EAAE,KAAK,QAAQ,GAAG,MAAM,UAAU,CAAC,CAAC;AAAA,QAChD;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACF,CAAC;AAQD,IAAM,SAAiB,CAAC,QAAQ;AAC9B,MAAI,UAAU,SAAS,QAAQ;AACjC;AAEA,IAAO,cAAQ;","names":["raf"]}